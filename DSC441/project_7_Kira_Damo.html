<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kira Damo">

<title>Project 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="project_7_Kira_Damo_files/libs/clipboard/clipboard.min.js"></script>
<script src="project_7_Kira_Damo_files/libs/quarto-html/quarto.js"></script>
<script src="project_7_Kira_Damo_files/libs/quarto-html/popper.min.js"></script>
<script src="project_7_Kira_Damo_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="project_7_Kira_Damo_files/libs/quarto-html/anchor.min.js"></script>
<link href="project_7_Kira_Damo_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="project_7_Kira_Damo_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="project_7_Kira_Damo_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="project_7_Kira_Damo_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="project_7_Kira_Damo_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project 7</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kira Damo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<hr>
<section id="project-guidelines-and-requirements" class="level2">
<h2 class="anchored" data-anchor-id="project-guidelines-and-requirements">Project Guidelines and Requirements</h2>
<hr>
<section id="guidelines" class="level3">
<h3 class="anchored" data-anchor-id="guidelines">Guidelines</h3>
<ul>
<li><strong>Do not share assignment questions or solutions with anyone.</strong> This includes printing, distributing, or posting them on any online platform or social media.</li>
<li><strong>Peer discussion is permitted for general concepts or troubleshooting, but NOT for sharing code or specific solutions.</strong></li>
<li>Complete your coding tasks within the R code chunks provided under each question.</li>
<li>Write clear, well-commented code. Use <code>#</code> to add explanations within code chunks as needed.</li>
<li>Use the markdown sections to provide written explanations, interpretations, and conclusions.</li>
<li>Complete the assignment independently. Reference materials such as textbooks, R documentation, and reputable online resources may be used for support.</li>
<li>Ensure your name is included in the Honor Pledge section.</li>
</ul>
<hr>
</section>
<section id="required-software-and-packages" class="level3">
<h3 class="anchored" data-anchor-id="required-software-and-packages">Required Software and Packages</h3>
<ul>
<li>R version 4.4.2 or higher is recommended.</li>
<li>RStudio version 2025.05.1 Build 513 or higher is recommended.</li>
<li>Make sure that the packages used in the project are installed and loaded in your R environment.</li>
</ul>
<hr>
</section>
<section id="deliverables" class="level3">
<h3 class="anchored" data-anchor-id="deliverables">Deliverables</h3>
<ol type="1">
<li><strong>Prepare Your Quarto Document:</strong>
<ul>
<li><p>Your Quarto <code>.qmd</code> file should be fully executed, with all outputs visible under the relevant code chunks.</p></li>
<li><p><strong>Do not include any active code for installing packages (such as <code>install.packages()</code>) or using the <code>View()</code> function or functions for checking raw data in your final document.</strong></p>
<p>When preparing your document for rendering (knitting), certain types of code should be removed or commented out to ensure smooth execution. The table shows three categories of problematic code: package installation commands (which belong in the console), View() functions (which create interactive windows that break during knitting), and basic data inspection commands (which should be replaced with meaningful analysis). Following these guidelines helps create clean, professional R Markdown documents that render without errors.</p></li>
</ul></li>
</ol>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>What to Remove</th>
<th>Why Remove It</th>
<th>Example Code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Package Installation Commands</td>
<td>These should be run in the console, not in your R Markdown document. They only need to be run once to install packages.</td>
<td><del><code>install.packages("tidyverse")</code></del></td>
</tr>
<tr class="even">
<td>View() Function Calls</td>
<td>The <code>View()</code> function opens interactive windows that don’t work in knitted or rendered documents and can cause errors.</td>
<td><del><code>View(mydata)</code></del> <br> <del><code>mydata |&gt; View()</code></del></td>
</tr>
<tr class="odd">
<td>Raw Data Inspection</td>
<td>These commands are for interactive data exploration and don’t provide meaningful output in final documents.</td>
<td><del><code>mydata</code></del> <br> <del><code>head(mydata)</code></del> <br> <del><code>tail(mydata)</code></del> <br> <del><code>str(mydata)</code></del> <br> <del><code>glimpse(mydata)</code></del></td>
</tr>
</tbody>
</table>
<p>Key Points:</p>
<ul>
<li>Package installation should be done separately in the R console</li>
<li>Interactive viewing functions (<code>View()</code>) don’t work in knitted or rendered documents</li>
<li>Raw data inspection commands should be replaced with meaningful analysis or visualizations</li>
</ul>
<p>Best Practice: Remove or comment out these lines before rendering your final R Markdown document to ensure clean, error-free output.</p>
<ol start="2" type="1">
<li><strong>File Naming Convention:</strong>
<ul>
<li>Name your project exactly as follows, using all lowercase, underscores, and leading zero for project number:
<ul>
<li><code>project_##_firstname_lastname.qmd</code></li>
<li>Example: <code>project_01_ilyas_ustun.qmd</code></li>
</ul></li>
</ul></li>
<li><strong>Rendering:</strong>
<ul>
<li>Compile your Quarto document into an HTML report by clicking the <code>Render</code> button in RStudio. This will produce a <code>project_##_firstname_lastname.html</code> file in the same directory.</li>
</ul></li>
<li><strong>Submission:</strong>
<ul>
<li>Submit both the <code>.qmd</code> and <code>.html</code> files to the designated submission folder.</li>
</ul></li>
</ol>
<hr>
<blockquote class="blockquote">
<p><strong>File Management Tip:</strong> If you are going to read in a data file, store all data files (e.g., <code>.csv</code>, <code>.xlsx</code>, <code>.xls</code>, <code>.txt</code>) in the same folder as your script for convenience. Otherwise, specify the full file path for your data.</p>
</blockquote>
<hr>
<blockquote class="blockquote">
<p>If you encounter errors when rendering your document to HTML, carefully review and correct your code. The entire document must run without errors for successful rendering.</p>
</blockquote>
<hr>
</section>
<section id="evaluation-criteria" class="level3">
<h3 class="anchored" data-anchor-id="evaluation-criteria">Evaluation Criteria</h3>
<ul>
<li><strong>Accuracy and Completeness:</strong> Each question is worth equal points. The project is graded out of <strong>100 points</strong>.</li>
<li><strong>Code Output</strong>: Your Quarto .qmd file should be fully executed, with all outputs visible under the relevant code chunks.</li>
<li><strong>Code Quality:</strong> Code should be correct, well-structured, and commented appropriately.</li>
<li><strong>Visualizations:</strong> Data visualizations must be accurate, relevant, and effectively labeled.</li>
<li><strong>Adherence to Guidelines:</strong> File naming, formatting, and submission instructions must be followed.</li>
</ul>
<hr>
</section>
<section id="troubleshooting-and-support" class="level3">
<h3 class="anchored" data-anchor-id="troubleshooting-and-support">Troubleshooting and Support</h3>
<p>If you require assistance or experience technical issues while working on the project, please follow these steps to get the help you need:</p>
<ul>
<li>Check Online Resources: First, try to find the answer to your question or solution to your problem by checking online resources such as:
<ul>
<li>Stack Overflow (for R programming-related issues)</li>
<li>RStudio Community (for RStudio and R-related discussions)</li>
<li>R-bloggers (for R tutorials, tips, and best practices)</li>
</ul></li>
<li>Discussion Forum: If you can’t find the information you’re looking for, post your question on the course discussion forum. Your peers or instructors may have encountered a similar issue and can provide insights or guidance on R or data science concepts.</li>
<li>Provide Context: When posting your question, please include relevant details such as:
<ul>
<li>A clear description of the problem or question</li>
<li>The code you are working with (if applicable)</li>
<li>Any error messages you are encountering</li>
<li>The name of the dataset or context related to your question</li>
</ul></li>
<li>Contact the professor: If you’re unable to resolve your issue through the above steps, or if your question is of a personal or sensitive nature, please don’t hesitate to contact Dr.&nbsp;Ilyas Ustun directly.</li>
</ul>
<p>By following these steps, you’ll not only potentially get a quicker resolution to your issue, but you’ll also contribute to building a resourceful and supportive community within the course.</p>
<hr>
</section>
<section id="submission-checklist" class="level3">
<h3 class="anchored" data-anchor-id="submission-checklist">Submission Checklist</h3>
<p>Before submitting your assignment, please confirm each item:</p>
<ul class="task-list">
<li><label><input type="checkbox" checked="">My <code>.qmd</code> file is named correctly (<code>project_##_firstname_lastname.qmd</code>) and runs without errors.</label></li>
<li><label><input type="checkbox" checked="">All code chunks have been executed, and outputs are visible under each question.</label></li>
<li><label><input type="checkbox" checked="">There is no active <code>install.packages()</code> or <code>View()</code> code (these are commented out or removed).</label></li>
<li><label><input type="checkbox" checked="">The final HTML report is rendered and saved in the same directory as the <code>.qmd</code> file.</label></li>
<li><label><input type="checkbox" checked="">Both <code>.qmd</code> and <code>.html</code> files are uploaded to the designated submission folder.</label></li>
<li><label><input type="checkbox" checked="">All data visualizations are appropriate, clear, and effectively labeled.</label></li>
<li><label><input type="checkbox" checked="">My name and the date are included in the Honor Pledge section.</label></li>
<li><label><input type="checkbox" checked="">I have not shared or received code or solutions from others.</label></li>
</ul>
<hr>
</section>
<section id="honor-pledge" class="level3">
<h3 class="anchored" data-anchor-id="honor-pledge">Honor Pledge</h3>
<p><strong>Honor Pledge:</strong><br>
I affirm that all work on this assignment is my own and that I have not shared or received unauthorized assistance.</p>
<ul>
<li>Name: Kira Damo</li>
<li>Date: July 19th, 2025</li>
</ul>
<hr>
</section>
</section>
<section id="predicting-diamond-prices-with-linear-regression" class="level1">
<h1>Predicting Diamond Prices with Linear Regression</h1>
<section id="project-overview-and-data-description" class="level2">
<h2 class="anchored" data-anchor-id="project-overview-and-data-description">Project Overview and Data Description</h2>
<section id="what-youll-learn" class="level3">
<h3 class="anchored" data-anchor-id="what-youll-learn">What You’ll Learn</h3>
<ul>
<li>How to explore variable correlations using a correlation matrix and plot.</li>
<li>How to create insightful visualizations to understand variable relationships using <code>ggplot2</code>.</li>
<li>How to fit, interpret, and visualize a simple linear regression model.</li>
<li>How to build, diagnose, and improve a multiple linear regression model.</li>
</ul>
</section>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>Welcome to the linear regression project! In this assignment, you will step into the role of a data analyst for a jewelry company. Your goal is to understand the factors that influence the price of a diamond and to build a predictive model to estimate its value. We will use the well-known <code>diamonds</code> dataset for this analysis. This project will guide you through the process of data exploration, visualization, and building and interpreting linear regression models in R.</p>
</section>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<p>We will be using the <code>diamonds</code> dataset, which is included in the <code>ggplot2</code> R package. This dataset contains the prices and other attributes of almost 54,000 round-cut diamonds.</p>
</section>
<section id="explanation-of-variables" class="level3">
<h3 class="anchored" data-anchor-id="explanation-of-variables">Explanation of Variables</h3>
<p>The dataset contains 53,940 rows and 10 variables. The primary variables we will focus on are:</p>
<ul>
<li><strong>price</strong>: The price of the diamond in US dollars (<code>$326</code>–<code>$18,823</code>). This will be our target (dependent) variable.</li>
<li><strong>carat</strong>: The weight of the diamond (<code>0.2</code>–<code>5.01</code>). This is a key predictor.</li>
<li><strong>cut</strong>: The quality of the cut (Fair, Good, Very Good, Premium, Ideal). This is an ordered categorical variable.</li>
<li><strong>color</strong>: Diamond color, from D (best) to J (worst).</li>
<li><strong>clarity</strong>: A measurement of how clear the diamond is (I1 (worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF (best)).</li>
<li><strong>depth</strong>: Total depth percentage: <code>z / mean(x, y)</code>.</li>
<li><strong>table</strong>: Width of top of diamond relative to widest point.</li>
<li><strong>x</strong>: Length in mm.</li>
<li><strong>y</strong>: Width in mm.</li>
<li><strong>z</strong>: Depth in mm.</li>
</ul>
<p>You can find more information about this dataset by running <code>?diamonds</code> in your R console after loading the <code>ggplot2</code> package.</p>
</section>
<section id="setup-loading-libraries" class="level3">
<h3 class="anchored" data-anchor-id="setup-loading-libraries">Setup: Loading Libraries</h3>
<p>Before we begin the questions, we need to load the necessary libraries. The <code>tidyverse</code> is a collection of essential data science packages (including <code>ggplot2</code> and <code>dplyr</code>), and <code>ggcorrplot</code> is a great tool for visualizing correlation matrices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the tidyverse and ggcorrplot packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="questions" class="level2">
<h2 class="anchored" data-anchor-id="questions">Questions</h2>
<hr>
<section id="question-1-exploring-numeric-variable-correlations" class="level3">
<h3 class="anchored" data-anchor-id="question-1-exploring-numeric-variable-correlations">Question 1: Exploring Numeric Variable Correlations</h3>
<p>Understanding how numeric variables relate to each other is a great first step in any analysis. A correlation matrix is a powerful tool for this, showing the correlation coefficient between every pair of variables.</p>
<p><strong>Task:</strong> Create a correlation matrix for the numeric variables in the <code>diamonds</code> dataset and visualize it using the <code>ggcorrplot()</code> function.</p>
<p><strong>Hints:</strong></p>
<ul>
<li>First, you need to select only the columns that are numeric from the <code>diamonds</code> dataset.</li>
<li>Then, you’ll need a function to compute the correlation matrix on this numeric data.</li>
<li>Finally, pass the resulting correlation matrix into the visualization function from the <code>ggcorrplot</code> package.</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> diamonds  <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_if</span>(is.numeric)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(<span class="fu">cor</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="project_7_Kira_Damo_files/figure-html/q1-solution-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#selected variables that are numeric. Used ggcorplot to plot correlation matrix.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="question-2-visualizing-key-relationships-with-scatter-plots" class="level3">
<h3 class="anchored" data-anchor-id="question-2-visualizing-key-relationships-with-scatter-plots">Question 2: Visualizing Key Relationships with Scatter Plots</h3>
<p>Based on the correlation plot, <code>carat</code> has the strongest relationship with <code>price</code>. But what about other variables, like <code>depth</code>? A scatter plot is the best way to see the shape and strength of the relationship between two continuous variables.</p>
<p><strong>Task:</strong> Create two separate scatter plots: 1. <code>price</code> (y-axis) vs.&nbsp;<code>carat</code> (x-axis). 2. <code>price</code> (y-axis) vs.&nbsp;<code>depth</code> (x-axis).</p>
<p><strong>Hints:</strong></p>
<ul>
<li>For each plot, you will use the <code>ggplot()</code> function.</li>
<li>Map the variables to the <code>x</code> and <code>y</code> aesthetics. The geometric layer you need to add creates points.</li>
<li>You will need to write two separate blocks of <code>ggplot</code> code.</li>
<li>To speed up plotting, consider using a random sample of 10,000 rows from the dataset.</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>q2_df <span class="ot">=</span> <span class="fu">sample_n</span>(diamonds, <span class="dv">10000</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>q2_p1 <span class="ot">=</span> <span class="fu">ggplot</span>(q2_df, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Carat"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Price"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Price vs Carat"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>q2_p1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="project_7_Kira_Damo_files/figure-html/q2-solution-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>q2_p2 <span class="ot">=</span> <span class="fu">ggplot</span>(q2_df, <span class="fu">aes</span>(<span class="at">x =</span> depth, <span class="at">y =</span> price)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"red"</span>)  <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Depth"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Price"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Price vs Depth"</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>q2_p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="project_7_Kira_Damo_files/figure-html/q2-solution-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#created scatter plots with provided variables. Used a sample size of 10000.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="question-3-fitting-a-simple-linear-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="question-3-fitting-a-simple-linear-regression-model">Question 3: Fitting a Simple Linear Regression Model</h3>
<p>The scatter plot showed a clear, strong relationship between <code>carat</code> and <code>price</code>. Let’s quantify this relationship by building our first predictive model: a simple linear regression that uses <code>carat</code> to predict <code>price</code>.</p>
<p><strong>Task:</strong> Fit a linear model that predicts <code>price</code> as a function of <code>carat</code>. Store the model object in a variable named <code>simple_model</code>.</p>
<p><strong>Hints:</strong></p>
<ul>
<li>R has a specific function for fitting linear models, often abbreviated to two letters.</li>
<li>The relationship between the dependent and independent variable is defined with a formula, using a tilde (<code>~</code>).</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>simple_model <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> price <span class="sc">~</span> carat, <span class="at">data=</span>diamonds)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>simple_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ carat, data = diamonds)

Coefficients:
(Intercept)        carat  
      -2256         7756  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#created linear model with lm function.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="question-4-interpreting-the-simple-linear-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="question-4-interpreting-the-simple-linear-regression-model">Question 4: Interpreting the Simple Linear Regression Model</h3>
<p>Fitting the model is just the first step. Now we need to interpret what it tells us. The coefficients of the model are crucial: the intercept tells us the predicted starting point, and the slope tells us how much the price changes for each one-unit increase in carat.</p>
<p><strong>Task:</strong> Display the detailed summary of <code>simple_model</code>. Based on the output, what is the estimated price of a diamond if its carat is zero? For every one-unit increase in carat, how much is the price expected to increase?</p>
<p><strong>Hints:</strong></p>
<ul>
<li>There’s a function that provides a rich summary of a model object, including coefficients, p-values, and R-squared value.</li>
<li>The answer to the first question is the <code>(Intercept)</code> value. The answer to the second is the coefficient next to the <code>carat</code> variable.</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(simple_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ carat, data = diamonds)

Residuals:
     Min       1Q   Median       3Q      Max 
-18585.3   -804.8    -18.9    537.4  12731.7 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2256.36      13.06  -172.8   &lt;2e-16 ***
carat        7756.43      14.07   551.4   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1549 on 53938 degrees of freedom
Multiple R-squared:  0.8493,    Adjusted R-squared:  0.8493 
F-statistic: 3.041e+05 on 1 and 53938 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The formula is price = 7756.43 * carat - 2256.36</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="question-5-visualizing-the-regression-line" class="level3">
<h3 class="anchored" data-anchor-id="question-5-visualizing-the-regression-line">Question 5: Visualizing the Regression Line</h3>
<p>A great way to understand your simple linear regression model is to see it visually. We can do this by overlaying the regression line on top of the scatter plot data.</p>
<p><strong>Task:</strong> Create the scatter plot of <code>price</code> vs.&nbsp;<code>carat</code> again, but this time, add the linear regression line to the plot.</p>
<p><strong>Hints:</strong></p>
<ul>
<li>Start with the <code>ggplot</code> code for the scatter plot from Question 2.</li>
<li>Add another layer to the plot. This layer should be a smoothing line, but you need to specify the <code>method</code> to be a linear model (<code>"lm"</code>).</li>
<li>To speed up plotting, consider using a random sample of 10,000 rows from the dataset.</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>q5_df <span class="ot">=</span> <span class="fu">sample_n</span>(diamonds, <span class="dv">10000</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(q5_df, <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"Carat"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"Price"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Price vs Carat"</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="project_7_Kira_Damo_files/figure-html/q5-solution-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#used plot from question 2 and new sample of 10000. added geom_smooth with lm method. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="the-following-questions-build-on-each-other-to-create-and-refine-a-final-model." class="level3">
<h3 class="anchored" data-anchor-id="the-following-questions-build-on-each-other-to-create-and-refine-a-final-model."><strong>The following questions build on each other to create and refine a final model.</strong></h3>
<hr>
</section>
<section id="question-6-building-a-multiple-linear-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="question-6-building-a-multiple-linear-regression-model">Question 6: Building a Multiple Linear Regression Model</h3>
<p>A simple model is a good start, but price is influenced by more than just carat. Let’s build a multiple linear regression model by adding the <code>cut</code> and <code>color</code> variables as predictors to see if we can create a more accurate model.</p>
<p><strong>Task:</strong> Fit a multiple linear regression model to predict <code>price</code> using <code>carat</code>, <code>cut</code>, and <code>color</code>. Store the model in an object named <code>multi_model</code>.</p>
<p><strong>Hints:</strong></p>
<ul>
<li>You will use the same <code>lm()</code> function as before.</li>
<li>To add more independent variables to the formula, you can use the <code>+</code> sign.</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>multi_model <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> price <span class="sc">~</span> carat <span class="sc">+</span> cut <span class="sc">+</span> color, <span class="at">data=</span>diamonds)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>multi_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ carat + cut + color, data = diamonds)

Coefficients:
(Intercept)        carat        cut.L        cut.Q        cut.C        cut^4  
   -3149.82      8183.74      1243.35      -531.75       372.06        76.15  
    color.L      color.Q      color.C      color^4      color^5      color^6  
   -1579.17      -732.85      -107.41        81.63      -138.64      -161.09  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#added other variables to model.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="question-7-interpreting-the-multiple-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="question-7-interpreting-the-multiple-regression-model">Question 7: Interpreting the Multiple Regression Model</h3>
<p>Now that we have a more complex model, let’s interpret its summary. Specifically, we want to know how well the model explains the variation in price.</p>
<p><strong>Task:</strong> Using the <code>multi_model</code> from the previous question, display its summary and find the “Adjusted R-squared” value.</p>
<p><strong>Hints:</strong></p>
<ul>
<li>Use the <code>summary()</code> function on your new model object.</li>
<li>Look through the summary output for a specific line item that measures the proportion of variance explained by the model, adjusted for the number of predictors.</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multi_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ carat + cut + color, data = diamonds)

Residuals:
     Min       1Q   Median       3Q      Max 
-17313.9   -751.2    -83.9    543.6  12273.0 

Coefficients:
            Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept) -3149.82      15.76 -199.905  &lt; 2e-16 ***
carat        8183.74      13.90  588.885  &lt; 2e-16 ***
cut.L        1243.35      24.74   50.260  &lt; 2e-16 ***
cut.Q        -531.75      21.93  -24.252  &lt; 2e-16 ***
cut.C         372.06      19.16   19.417  &lt; 2e-16 ***
cut^4          76.15      15.39    4.949 7.49e-07 ***
color.L     -1579.17      21.72  -72.699  &lt; 2e-16 ***
color.Q      -732.85      19.86  -36.902  &lt; 2e-16 ***
color.C      -107.41      18.64   -5.763 8.32e-09 ***
color^4        81.63      17.12    4.769 1.85e-06 ***
color^5      -138.64      16.18   -8.568  &lt; 2e-16 ***
color^6      -161.09      14.68  -10.973  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1432 on 53928 degrees of freedom
Multiple R-squared:  0.8711,    Adjusted R-squared:  0.8711 
F-statistic: 3.315e+04 on 11 and 53928 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Adjusted R-Squared value: 0.8711 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="question-8-checking-model-assumptions-with-a-diagnostic-plot" class="level3">
<h3 class="anchored" data-anchor-id="question-8-checking-model-assumptions-with-a-diagnostic-plot">Question 8: Checking Model Assumptions with a Diagnostic Plot</h3>
<p>A key assumption of linear regression is that the residuals (the prediction errors) should have a constant variance (homoscedasticity). A “Residuals vs.&nbsp;Fitted” plot is the standard way to check this.</p>
<p><strong>Task:</strong> Create a “Residuals vs.&nbsp;Fitted” plot for the <code>multi_model</code>. What do you observe about the spread of the points?</p>
<p><strong>Hints:</strong></p>
<ul>
<li>R has a built-in <code>plot()</code> function that, when used on a model object, can generate several useful diagnostic plots.</li>
<li>Calling <code>plot(your_model_object, which = 1)</code> will produce the specific plot you need. Look for a “funnel” shape in the points.</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(multi_model, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="project_7_Kira_Damo_files/figure-html/q8-solution-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the points are mostly clustered together but then fall in a negative direction. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="question-9-improving-the-model-with-log-transformations" class="level3">
<h3 class="anchored" data-anchor-id="question-9-improving-the-model-with-log-transformations">Question 9: Improving the Model with Log Transformations</h3>
<p>The diagnostic plot from Q8 showed that our model’s errors are not constant. This, together with the nonlinear relationship observed in Q2, suggests that transforming both the dependent variable and some predictors might improve the model. A common and effective approach is to take the natural logarithm. Here we will take the natural logarithm of both <code>price</code> and <code>carat</code>.</p>
<p><strong>Task:</strong> Fit a new linear model where you predict the <code>log()</code> of <code>price</code> using the <code>log()</code> of <code>carat</code>, along with <code>cut</code> and <code>color</code>. Then, create the “Residuals vs.&nbsp;Fitted” plot for this new model to check if the issues with non-linearity and heteroscedasticity have improved. Check the summary of the model whether the <span class="math inline">\(R^2\)</span> value has improved.</p>
<p><strong>Hints:</strong></p>
<ul>
<li>You can apply <code>log()</code> directly inside the <code>lm()</code> formula for both the response and predictors.</li>
<li>Use the <code>plot()</code> function on the fitted model object to generate diagnostic plots as before.</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>log_model <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(price) <span class="sc">~</span> <span class="fu">log</span>(carat) <span class="sc">+</span> cut <span class="sc">+</span> color, <span class="at">data=</span>diamonds)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log_model, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="project_7_Kira_Damo_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the r^2 has improved. the points are more in line with fitted line.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="question-10-making-predictions-with-the-final-model" class="level3">
<h3 class="anchored" data-anchor-id="question-10-making-predictions-with-the-final-model">Question 10: Making Predictions with the Final Model</h3>
<p>The ultimate goal of a model is often to make predictions. Now that we have a more robust model (<code>log_model</code>), let’s use it to predict the price of a new, hypothetical diamond.</p>
<p><strong>Task:</strong> Predict the price of a 1.5 carat, ‘Ideal’ cut, ‘G’ color diamond using your <code>log_model</code>. Remember that your model predicts the log of the price, so you will need to transform the result back to the original dollar scale.</p>
<p><strong>Hints:</strong></p>
<ul>
<li>First, create a new data frame with a single row containing the values for the diamond you want to predict. Make sure the column names match the original data exactly.</li>
<li>Use the <code>predict()</code> function, passing your <code>log_model</code> and the new data frame to it.</li>
<li>The result of <code>predict()</code> will be on the log scale. You’ll need an inverse function to convert it back to dollars (the opposite of <code>log()</code> is <code>exp()</code>).</li>
</ul>
<p><strong>Solution:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>diamonds_1<span class="fl">.5</span> <span class="ot">=</span> diamonds <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(carat <span class="sc">==</span> <span class="fl">1.5</span> <span class="sc">&amp;</span> cut <span class="sc">==</span> <span class="st">'Ideal'</span> <span class="sc">&amp;</span> color <span class="sc">==</span> <span class="st">'G'</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">predict</span>(log_model, diamonds_1<span class="fl">.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3        4        5        6        7        8 
10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 
       9       10       11       12       13       14       15       16 
10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 
      17       18       19       20       21       22       23       24 
10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 10843.06 
      25       26       27       28       29 
10843.06 10843.06 10843.06 10843.06 10843.06 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filtered for diamonds with a 1.5 carat. predicted for price using log model and new dataset. used exp() to convert back into dollars.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>